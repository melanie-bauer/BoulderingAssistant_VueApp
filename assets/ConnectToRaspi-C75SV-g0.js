import{_ as F}from "./HomeButton-CIcrN8iR.js";import{_ as R,r as y,f as H,g as k,h as M,i as j,o as d,c as l,b as C,F as D,j as B,u as W,n as E,k as X,p as Y,e as K,a as S}from "./index-tZjI4x_6.js";const O= c=>(Y("data-v-fd7472b6"),c=c(),K(),c),N={id:"container"},P=O(()=>C("video",{id:"video",autoplay:"",style:{display:"none"}},null,-1)),U=["id","onMousedown","onTouchstart"],L=20,b=60,V={__name:"Canvas",setup(c){const o=y(null),r=y(!1),u=y(null),h=H({x:0,y:0}),n=H({Head:{id:"Head",x:160,y:120}}),I=k(()=>{const e=["Head","item"];return Object.fromEntries(Object.entries(n).filter(([t])=>!e.includes(t)))});let _=!1;const i=y();let g;async function w(){try{const t=await(await fetch("http://localhost:3000/points")).json();Object.assign(n,t.reduce((a, s)=>(a[s.id]=s,a),{})),x(n),_=!0}catch(e){console.error("Error fetching data:",e)}}function x(e){const t=o.value.getContext("2d");t.lineWidth=5,t&&(t.clearRect(0,0,o.value.width,o.value.height),t.drawImage(i.value,0,0,o.value.width,o.value.height),t.beginPath(),t.moveTo(e.Shoulders.x,e.Shoulders.y),t.lineTo(e.Hip.x,e.Hip.y),t.lineTo(e.LK.x,e.LK.y),t.lineTo(e.LF.x,e.LF.y),t.moveTo(e.Hip.x,e.Hip.y),t.lineTo(e.RK.x,e.RK.y),t.lineTo(e.RF.x,e.RF.y),t.moveTo(e.Shoulders.x,e.Shoulders.y),t.lineTo(e.LE.x,e.LE.y),t.lineTo(e.LH.x,e.LH.y),t.moveTo(e.Shoulders.x,e.Shoulders.y),t.lineTo(e.RE.x,e.RE.y),t.lineTo(e.RH.x,e.RH.y),t.moveTo(e.Shoulders.x,e.Shoulders.y),t.lineTo(e.Head.x,e.Head.y),t.strokeStyle="white",t.stroke())}function v(e, t){r.value=!0,u.value=t;const a=e.type.startsWith("touch")?e.touches[0].clientX:e.clientX,s=e.type.startsWith("touch")?e.touches[0].clientY:e.clientY;h.x=a-n[t].x,h.y=s-n[t].y,e.type==="mousedown"?(document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)):e.type==="touchstart"&&(document.addEventListener("touchmove",m),document.addEventListener("touchend",f))}function m(e){if(!r.value)return;const t=e.type.startsWith("touch")?e.touches[0].clientX:e.clientX,a=e.type.startsWith("touch")?e.touches[0].clientY:e.clientY;n[u.value].x=t-h.x,n[u.value].y=a-h.y,x(n)}async function f(){r.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",m),document.removeEventListener("touchend",f);const e=u.value;try{(await fetch(`http://localhost:3000/points/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n[e])})).ok||console.error("Failed to update points")}catch(t){console.error("Error updating points:",t)}}M(()=>{o.value=document.getElementById("canvas"),i.value=document.getElementById("video"),w(),setInterval(w,1e3),o.value.width=window.innerWidth,o.value.height=window.innerHeight,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1}).then(function(e){g=e,i.value.srcObject=e,i.value.play(),T()}).catch(function(e){console.error("Error accessing media devices.",e)}):console.error("getUserMedia not supported in this browser.")});const T=()=>{o.value.getContext("2d").drawImage(i.value,0,0,o.value.width,o.value.height),x(n),requestAnimationFrame(T)};return j(()=>{g&&g.getTracks().forEach(e=>{e.stop()})}),(e, t)=>(d(),l("div",N,[P,C("canvas",{id:"canvas",ref_key:"canvas",ref:o},null,512),(d(!0),l(D,null,B(I.value,(a, s)=>(d(),l("div",{id:s,key:s,style:E({top:a.y-L/2+"px",left:a.x-L/2+"px"}),class:"point",draggable:"true",onMousedown: p=>v(p,s),onTouchstart: p=>v(p,s)},null,44,U))),128)),W(_)?(d(),l("div",{key:0,id:"Head",style:E({top:n.Head.y-b/2+"px",left:n.Head.x-b/2+"px"}),class:"head",draggable:"true",onMousedown:t[0]||(t[0]= a=>v(a,"Head")),onTouchstart:t[1]||(t[1]= a=>v(a,"Head"))},null,36)):X("",!0)]))}},$=R(V,[["__scopeId","data-v-fd7472b6"]]),z={class:"container"},A={__name:"ConnectToRaspi",setup(c){return(o, r)=>(d(),l("div",z,[S($),S(F,{onClick:r[0]||(r[0]=()=>{})})]))}},G=R(A,[["__scopeId","data-v-4effc19a"]]);export{G as default};
